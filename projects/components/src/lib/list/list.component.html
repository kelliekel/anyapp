<!-- let-item not needed? -->
<!--*ngTemplateOutlet="estimateTemplate;context:ctx"-->

<mat-menu #sortMenu="matMenu">
  <button mat-menu-item [disabled]="true">
    {{config.locales.list_sortTitle}}
  </button>
  <mat-divider></mat-divider>
  <button mat-menu-item *ngFor="let sortOption of sortingFields" (click)="sort(sortOption)" [class.bold]="sortOption == settings?.sort">
    {{sortOption}}
  </button>
</mat-menu>

<aa-comp-button *ngIf="sortingFields && sortingFields.length > 0" [style]="'icon'" [matMenuTriggerFor]="sortMenu" 
  [tooltip]="(settings?.sort | sortLabel:settings?.sortType)">
  <aa-comp-icon [icon]="'sort'"></aa-comp-icon>
</aa-comp-button>

<aa-comp-search (onSearch)="search($event)" [placeholder]="config.locales.list_search"></aa-comp-search>

<mat-accordion>

  <div *ngIf="!pagedDataSource || pagedDataSource.length == 0">
    <aa-comp-hint>
      {{config.locales.list_noItemsText}}
    </aa-comp-hint>
  </div>

  <ng-container *ngFor="let item of pagedDataSource; let i = index">

    <mat-expansion-panel [expanded]="i == expandedIndex" (opened)="expandedIndex = $event;">
      <mat-expansion-panel-header>
        <!-- 
          <mat-panel-title>Personal data</mat-panel-title>
          <mat-panel-description>Type your name and age<mat-icon>account_circle</mat-icon></mat-panel-description> 
        -->
        <ng-template *ngIf="headerTemplate" ngFor let-item [ngForOf]="[item]" [ngForTemplate]="headerTemplate"></ng-template>
      </mat-expansion-panel-header>

      <ng-template matExpansionPanelContent *ngIf="contentTemplate" ngFor let-item [ngForOf]="[item]" [ngForTemplate]="contentTemplate"></ng-template>

      <mat-action-row *ngIf="footerTemplate">
        <ng-template ngFor let-item [ngForOf]="[item]" [ngForTemplate]="footerTemplate">
        </ng-template>

        <!-- <ng-template *ngIf="showDefaultFooterTemplate" ngFor let-item [ngForOf]="[item]" [ngForTemplate]="defaultFooterTemplate">          
        </ng-template>
        
        <ng-template #defaultFooterTemplate>
            <aa-comp-button color="warn" *ngIf="i > 0" (click)="setOpenedIndex(i-1)">Previous</aa-comp-button>
            <aa-comp-button *ngIf="i < dataSource.length" (click)="setOpenedIndex(i+1)">Next</aa-comp-button>
        </ng-template> -->
      </mat-action-row>
    </mat-expansion-panel>

  </ng-container>

</mat-accordion>

<div *ngIf="allowPaging">
  <mat-paginator showFirstLastButtons (page)="changePage($event)" [length]="collectionSize" [pageIndex]="settings?.page" [pageSize]="settings?.pageSize"></mat-paginator>
</div>